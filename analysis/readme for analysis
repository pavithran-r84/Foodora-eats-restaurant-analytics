this contains all the analysis part 
